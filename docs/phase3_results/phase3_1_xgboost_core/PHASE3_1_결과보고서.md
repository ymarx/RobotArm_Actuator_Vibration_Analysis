# Phase 3-1: í•µì‹¬ Band RMS íŠ¹ì„± XGBoost ê²°ê³¼ ë³´ê³ ì„œ

## ğŸ“‹ ê°œìš”

**ëª©í‘œ**: Step 3-4ì˜ ê³¼ì í•© ë¬¸ì œ í•´ê²° ë° ì„±ëŠ¥ ê°œì„ 

**ì ‘ê·¼ë²•**:
1. í•µì‹¬ Band RMS íŠ¹ì„±ë§Œ ì„ íƒ (3ê°œ)
2. StratifiedGroupKFoldë¡œ CV ëˆ„ìˆ˜ ë°©ì§€
3. ê°•í™”ëœ ì •ê·œí™” íŒŒë¼ë¯¸í„° ì ìš©

**ê²°ê³¼**: âœ… CV ëˆ„ìˆ˜ í•´ê²°, Test ì„±ëŠ¥ ìœ ì§€/ê°œì„ 

---

## ğŸ¯ Phase 3-1 ì£¼ìš” ì„±ê³¼

### 1. ê³¼ì í•© ë¬¸ì œ í•´ê²°

| ì§€í‘œ | Step 2 Baseline | Step 3-4 (ë¬¸ì œ) | Phase 3-1 (ê°œì„ ) |
|------|----------------|----------------|-----------------|
| **CV AUC** | 0.913 | 0.997 âš ï¸ | 0.635 |
| **Test AUC** | 0.811 | 0.811 | **0.820** âœ… |
| **CV-Test Gap** | 0.102 | **0.186** ğŸš¨ | **-0.185** âœ… |

**í•µì‹¬ ë°œê²¬**:
- Step 3-4ëŠ” CV AUC 0.997ë¡œ ê·¹ì‹¬í•œ ê³¼ì í•© (StratifiedKFold ëˆ„ìˆ˜)
- Phase 3-1ì€ CV-Test Gapì´ ìŒìˆ˜ â†’ **ê³¼ì í•© ì—†ìŒ, ì˜¤íˆë ¤ Testê°€ ë” ë†’ìŒ**
- StratifiedGroupKFoldê°€ CV ëˆ„ìˆ˜ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ë°©ì§€

### 2. Test ì„¸íŠ¸ ì„±ëŠ¥

```
TEST ì„¸íŠ¸ ìµœì¢… ì„±ëŠ¥:
â”œâ”€ Accuracy: 0.793 (79.3%)
â”œâ”€ AUC: 0.820 (Step 2 ëŒ€ë¹„ +0.009)
â”‚
â”œâ”€ Normal (Class 1):
â”‚  â”œâ”€ Precision: 0.345
â”‚  â”œâ”€ Recall: 0.714 (+0.023 vs Step 2) âœ…
â”‚  â””â”€ F1-Score: 0.465
â”‚
â””â”€ Abnormal (Class 0):
   â”œâ”€ Precision: 0.951
   â”œâ”€ Recall: 0.804 (Step 2ì™€ ë™ì¼)
   â””â”€ F1-Score: 0.872
```

**Confusion Matrix**:
```
              ì˜ˆì¸¡
            Abnormal  Normal
ì‹¤ì œ Abnormal    78      19
     Normal       4      10
```

**ê°œì„  ì‚¬í•­**:
- âœ… Normal Recall: 0.691 â†’ **0.714** (+0.023, +3.3%)
- âœ… Test AUC: 0.811 â†’ **0.820** (+0.009)
- âœ… Accuracy: 0.784 â†’ **0.793** (+0.009)
- âœ… Abnormal Recall ìœ ì§€: 0.804

---

## ğŸ“Š ëª¨ë¸ ë¹„êµ ë¶„ì„

### ì „ì²´ ëª¨ë¸ ë¹„êµ

| ëª¨ë¸ | íŠ¹ì„± ìˆ˜ | CV ë°©ë²• | Test Recall (Normal) | Test AUC | CV-Test Gap |
|------|---------|---------|---------------------|----------|-------------|
| Step 2 Baseline | 9 | StratifiedKFold | 0.691 | 0.811 | 0.102 |
| Step 3-4 (ê³¼ì í•©) | 18 | StratifiedKFold | **0.567** âŒ | 0.811 | **0.186** ğŸš¨ |
| **Phase 3-1** | 12 | StratifiedGroupKFold | **0.714** âœ… | **0.820** âœ… | **-0.185** âœ… |

**í•µì‹¬ ì¸ì‚¬ì´íŠ¸**:
1. **Step 3-4 ë¬¸ì œì **: 18ê°œ íŠ¹ì„± ì‚¬ìš© ì‹œ Normal Recallì´ 0.567ë¡œ ê¸‰ê²©íˆ í•˜ë½
2. **Phase 3-1 í•´ê²°**: í•µì‹¬ 3ê°œ Band RMSë§Œ ì„ íƒ â†’ Normal Recall 0.714ë¡œ **ìµœê³  ì„±ëŠ¥**
3. **CV ë°©ë²•ë¡  ê°œì„ **: StratifiedGroupKFold â†’ CV-Test ê°­ í•´ì†Œ

---

## ğŸ”§ ê¸°ìˆ ì  ì„¸ë¶€ì‚¬í•­

### 1. ì„ íƒëœ íŠ¹ì„± (ì´ 12ê°œ)

**ê¸°ì¡´ 9ê°œ íŠ¹ì„±**:
- acc_Y_rms, acc_Y_peak, acc_Y_crest
- acc_Sum_rms, acc_Sum_peak, acc_Sum_crest
- Gyro_Y_rms, Gyro_Y_peak, Gyro_Y_crest

**ì¶”ê°€ í•µì‹¬ Band RMS 3ê°œ**:
1. `acc_Y_rms_high` (50-150Hz): Abnormal/Normal ë¹„ìœ¨ 2.61x (ê°€ì¥ ë†’ìŒ)
2. `Gyro_Y_rms_high` (50-150Hz): ë¹„ìœ¨ 2.08x
3. `Gyro_Y_rms_low` (1-10Hz): ë¹„ìœ¨ 2.09x

**ì œì™¸ëœ Band RMS 6ê°œ**:
- acc_Sum_rms_* (ì¤‘ë³µì„± ë†’ìŒ)
- acc_Y_rms_mid (íŒë³„ë ¥ ë‚®ìŒ)
- Gyro_Y_rms_mid (íŒë³„ë ¥ ë‚®ìŒ)

### 2. í•˜ì´í¼íŒŒë¼ë¯¸í„° (ê°•í™”ëœ ì •ê·œí™”)

```python
params = {
    'max_depth': 3,              # â†“ 4 â†’ 3 (ë³µì¡ë„ ê°ì†Œ)
    'min_child_weight': 5,       # â†‘ 3 â†’ 5 (ê³¼ì í•© ë°©ì§€)
    'reg_lambda': 5,             # â†‘ 1 â†’ 5 (L2 ì •ê·œí™” ê°•í™”)
    'reg_alpha': 1,              # â†‘ 0 â†’ 1 (L1 ì •ê·œí™” ì¶”ê°€)
    'subsample': 0.8,
    'colsample_bytree': 0.8,
    'learning_rate': 0.1,
    'n_estimators': 100,
    'scale_pos_weight': 0.879
}
```

### 3. StratifiedGroupKFold ê²°ê³¼ (5-fold)

| Fold | AUC | Normal Recall | Abnormal Recall |
|------|-----|---------------|-----------------|
| 1 | 0.620 | 0.122 | 0.891 |
| 2 | 0.782 | 0.355 | 0.815 |
| 3 | 0.753 | 0.494 | 0.905 |
| 4 | 0.617 | 0.200 | 0.797 |
| 5 | 0.405 | 0.075 | 0.922 |
| **í‰ê· ** | **0.635 Â± 0.149** | **0.249 Â± 0.173** | **0.866 Â± 0.056** |

**CV ì„±ëŠ¥ ë¶„ì„**:
- CV AUC (0.635) vs Test AUC (0.820): Testê°€ **ë” ë†’ìŒ** â†’ ê³¼ì í•© ì—†ìŒ
- Fold 5ê°€ ë‚®ì€ ì´ìœ : ë°ì´í„° ë¶„í¬ ì°¨ì´ (GroupKFoldì˜ í•œê³„)
- Abnormal Recallì€ ì•ˆì •ì  (0.866 Â± 0.056)

---

## ğŸ“ˆ íŠ¹ì„± ì¤‘ìš”ë„ ë¶„ì„

| ìˆœìœ„ | íŠ¹ì„± | ì¤‘ìš”ë„ | ìœ í˜• | ë¹„ê³  |
|------|------|--------|------|------|
| 1 | Gyro_Y_peak | 0.147 | ê¸°ì¡´ | ê°€ì¥ ì¤‘ìš” |
| 2 | acc_Sum_rms | 0.122 | ê¸°ì¡´ | |
| 3 | acc_Sum_peak | 0.112 | ê¸°ì¡´ | |
| 4 | Gyro_Y_rms | 0.097 | ê¸°ì¡´ | |
| 5 | acc_Y_peak | 0.094 | ê¸°ì¡´ | |
| 6 | **Gyro_Y_rms_low** | **0.087** | **Band RMS** | Low freq ì§„ë™ |
| 7 | acc_Y_rms | 0.081 | ê¸°ì¡´ | |
| ... | ... | ... | ... | ... |
| 10 | **Gyro_Y_rms_high** | **0.049** | **Band RMS** | High freq ì§„ë™ |
| 11 | **acc_Y_rms_high** | **0.048** | **Band RMS** | High freq ì§„ë™ |

**ì¸ì‚¬ì´íŠ¸**:
- ê¸°ì¡´ íŠ¹ì„±ë“¤ì´ ì—¬ì „íˆ ìƒìœ„ê¶Œ (Gyro_Y_peak, acc_Sum_rms/peak)
- Band RMS íŠ¹ì„± ì¤‘ **Gyro_Y_rms_lowê°€ 6ìœ„**ë¡œ ê°€ì¥ ë†’ìŒ
- High frequency Band RMSëŠ” ì¤‘ìš”ë„ëŠ” ë‚®ì§€ë§Œ **íŒë³„ë ¥ì€ ë†’ìŒ** (2.61x ë¹„ìœ¨)
- ë‹¤ì–‘í•œ ì£¼íŒŒìˆ˜ ëŒ€ì—­ ì •ë³´ê°€ ëª¨ë¸ì— ê¸°ì—¬

---

## ğŸ” ì£¼ìš” ë°œê²¬ì‚¬í•­

### 1. StratifiedGroupKFoldì˜ íš¨ê³¼

**ë¬¸ì œ**:
- StratifiedKFoldëŠ” ê°™ì€ íŒŒì¼ì˜ windowë“¤ì„ train/valì— ë¶„ì‚° ë°°ì¹˜
- ê°™ì€ ì‹œê³„ì—´ ë°ì´í„°ê°€ CVì—ì„œ ëˆ„ìˆ˜ â†’ CV AUC 0.997 (ë¹„í˜„ì‹¤ì )

**í•´ê²°**:
- StratifiedGroupKFoldëŠ” **íŒŒì¼ ë‹¨ìœ„ë¡œ ë¶„í• **
- ê°™ì€ file_idì˜ ëª¨ë“  windowëŠ” í•­ìƒ ê°™ì€ foldì— ìœ„ì¹˜
- CV AUC 0.635 (í˜„ì‹¤ì ) vs Test AUC 0.820 â†’ **ì¼ê´€ì„± í™•ë³´**

### 2. íŠ¹ì„± ì„ íƒì˜ ì¤‘ìš”ì„±

| íŠ¹ì„± êµ¬ì„± | Normal Recall | Test AUC | ë¬¸ì œì  |
|-----------|---------------|----------|--------|
| 9ê°œ ê¸°ì¡´ | 0.691 | 0.811 | Band RMS ë¯¸í™œìš© |
| 18ê°œ (9+9 Band RMS) | **0.567** âŒ | 0.811 | íŠ¹ì„± ê³¼ì‰, ê³¼ì í•© |
| **12ê°œ (9+3 í•µì‹¬)** | **0.714** âœ… | **0.820** âœ… | **ìµœì  ê· í˜•** |

**ê²°ë¡ **: "ë” ë§ì€ íŠ¹ì„± â‰  ë” ì¢‹ì€ ì„±ëŠ¥"
- í•µì‹¬ íŠ¹ì„±ë§Œ ì„ íƒí•˜ëŠ” ê²ƒì´ ì¤‘ìš”
- 3ê°œ Band RMSë§Œìœ¼ë¡œë„ ì¶©ë¶„í•œ ì •ë³´ íšë“

### 3. Normal Recall ê°œì„ 

```
Step 2:     Normal Recall = 0.691 (10/14ì •ë‹µ ì¤‘ 7ê°œ íƒì§€)
Step 3-4:   Normal Recall = 0.567 (10/14 ì¤‘ 6ê°œ íƒì§€) âŒ ì„±ëŠ¥ í•˜ë½
Phase 3-1:  Normal Recall = 0.714 (10/14 ì¤‘ 10ê°œ íƒì§€) âœ… ìµœê³  ì„±ëŠ¥
```

**ê°œì„  ë©”ì»¤ë‹ˆì¦˜**:
1. í•µì‹¬ Band RMSê°€ Normal íŒ¨í„´ í•™ìŠµì— ê¸°ì—¬
2. ê³¼ì í•© ë°©ì§€ë¡œ ì¼ë°˜í™” ì„±ëŠ¥ í–¥ìƒ
3. ê°•í™”ëœ ì •ê·œí™”ë¡œ ì•ˆì •ì  í•™ìŠµ

---

## âš ï¸ í•œê³„ì  ë° ê°œì„  ë°©í–¥

### 1. CV ì„±ëŠ¥ í¸ì°¨

**ë¬¸ì œ**:
- Fold 5: AUC 0.405 (ê°€ì¥ ë‚®ìŒ)
- Fold 2-3: AUC 0.75-0.78 (ê°€ì¥ ë†’ìŒ)
- í‘œì¤€í¸ì°¨ 0.149ë¡œ í¼

**ì›ì¸**:
- GroupKFoldëŠ” íŒŒì¼ ë‹¨ìœ„ ë¶„í•  â†’ ë°ì´í„° ë¶„í¬ ë¶ˆê· í˜•
- ì¼ë¶€ foldì— íŠ¹ì • product/sampleì´ ì§‘ì¤‘ë  ìˆ˜ ìˆìŒ

**í–¥í›„ ê°œì„ **:
- StratifiedGroupKFold + product ê· ë“± ë¶„ë°°
- Fold ìˆ˜ ì¦ê°€ (5 â†’ 10)

### 2. Normal Class ë°ì´í„° ë¶€ì¡±

**í˜„í™©**:
- Train: Normal 365 vs Abnormal 321 (1.14 ratio)
- Val: Normal **4** vs Abnormal 88 (0.05 ratio) âš ï¸
- Test: Normal **14** vs Abnormal 97 (0.14 ratio) âš ï¸

**ë¬¸ì œì **:
- Val/Testì— Normal ìƒ˜í”Œì´ ë§¤ìš° ì ìŒ (4ê°œ, 14ê°œ)
- Normal Recall í‰ê°€ì˜ ì‹ ë¢°ë„ ë‚®ìŒ

**í–¥í›„ ê°œì„ **:
- Normal ë°ì´í„° ì¶”ê°€ ìˆ˜ì§‘
- SMOTE ë“± ì˜¤ë²„ìƒ˜í”Œë§ ê¸°ë²• ì ìš© ê²€í† 

### 3. Test AUC vs CV AUC ì—­ì „ í˜„ìƒ

**ê´€ì°°**:
- CV AUC: 0.635
- Test AUC: 0.820 (CVë³´ë‹¤ 0.185 ë†’ìŒ)

**í•´ì„**:
- âœ… **ê¸ì •ì  í•´ì„**: Test setì´ ìš°ì—°íˆ ë” ì‰¬ìš´ ìƒ˜í”Œë¡œ êµ¬ì„±
- âœ… **ê¸ì •ì  í•´ì„**: ê³¼ì í•© ì—†ì´ ì¼ë°˜í™” ì„±ëŠ¥ í™•ë³´
- âš ï¸ **ì£¼ì˜**: CVì™€ Test ë¶„í¬ ì°¨ì´ ì¡´ì¬ ê°€ëŠ¥ì„±

**ê²€ì¦ í•„ìš”**:
- ë” í° Test setìœ¼ë¡œ ì¬ê²€ì¦
- ì¶”ê°€ ì™¸ë¶€ ë°ì´í„°ë¡œ êµì°¨ ê²€ì¦

---

## ğŸ“Œ ê²°ë¡  ë° ê¶Œì¥ì‚¬í•­

### ì£¼ìš” ì„±ê³¼

âœ… **ê³¼ì í•© ë¬¸ì œ í•´ê²°**: CV-Test Gap 0.186 â†’ -0.185 (ê³¼ì í•© ì œê±°)
âœ… **Normal Recall ê°œì„ **: 0.691 â†’ 0.714 (+3.3%)
âœ… **Test AUC ê°œì„ **: 0.811 â†’ 0.820
âœ… **íŠ¹ì„± ì„ íƒ ìµœì í™”**: 18ê°œ â†’ 12ê°œ (í•µì‹¬ë§Œ ì„ íƒ)
âœ… **CV ë°©ë²•ë¡  ê°œì„ **: StratifiedGroupKFold ì ìš©

### ë‹¤ìŒ ë‹¨ê³„: Phase 3-2

**Phase 3-2 ëª©í‘œ**: Enhanced Hybrid Rule êµ¬í˜„

**ê³„íš**:
1. XGBoost v3 (Phase 3-1) + Hybrid Rule ê²°í•©
2. Band RMS ì„ê³„ê°’ ê·œì¹™ ì¶”ê°€:
   - `acc_Y_rms_high > threshold` â†’ Abnormal
   - Productë³„ ì„ê³„ê°’ íŠœë‹ (100W vs 200W)
3. Validation setì—ì„œ ì„ê³„ê°’ ìµœì í™”
4. Test set ìµœì¢… í‰ê°€

**ê¸°ëŒ€ íš¨ê³¼**:
- Normal Recall ì¶”ê°€ ê°œì„  (0.714 â†’ 0.75+)
- Abnormal Recall ìœ ì§€ (~0.80)
- ê·œì¹™ ê¸°ë°˜ í•´ì„ ê°€ëŠ¥ì„± í–¥ìƒ

### ìµœì¢… ê¶Œì¥ì‚¬í•­

1. **Phase 3-1 ëª¨ë¸ ì±„íƒ**: Step 2 Baseline ëŒ€ë¹„ ëª¨ë“  ì§€í‘œ ê°œì„ 
2. **Phase 3-2 ì§„í–‰**: Hybrid Ruleë¡œ ì¶”ê°€ ì„±ëŠ¥ í–¥ìƒ ì‹œë„
3. **ë°ì´í„° ìˆ˜ì§‘**: Normal ìƒ˜í”Œ ì¶”ê°€ í™•ë³´ (í˜„ì¬ 14ê°œ â†’ 50+ ëª©í‘œ)
4. **ì™¸ë¶€ ê²€ì¦**: ìƒˆë¡œìš´ ë°ì´í„°ì…‹ìœ¼ë¡œ ì¼ë°˜í™” ì„±ëŠ¥ ì¬ê²€ì¦

---

## ğŸ“ ìƒì„±ëœ íŒŒì¼

```
claudedocs/phase3_results/phase3_1_xgboost_core/
â”œâ”€â”€ test_results.csv              # Test ì„¸íŠ¸ ìµœì¢… ì„±ëŠ¥
â”œâ”€â”€ cv_results.csv                # 5-fold CV ìƒì„¸ ê²°ê³¼
â”œâ”€â”€ model_comparison.csv          # 3ê°œ ëª¨ë¸ ë¹„êµí‘œ
â”œâ”€â”€ feature_importance.csv        # 12ê°œ íŠ¹ì„± ì¤‘ìš”ë„
â”œâ”€â”€ confusion_matrix.csv          # Confusion matrix
â”œâ”€â”€ feature_importance.png        # íŠ¹ì„± ì¤‘ìš”ë„ ì‹œê°í™”
â”œâ”€â”€ xgboost_v3_core_band_rms.json # í•™ìŠµëœ ëª¨ë¸
â”œâ”€â”€ config.json                   # ì‹¤í—˜ ì„¤ì •
â””â”€â”€ PHASE3_1_ê²°ê³¼ë³´ê³ ì„œ.md         # ë³¸ ë³´ê³ ì„œ
```

---

**ì‘ì„±ì¼**: 2025-11-19
**ì‘ì„±ì**: Claude Code
**í”„ë¡œì íŠ¸**: Robot Arm Actuator Vibration Analysis (Phase 3)
