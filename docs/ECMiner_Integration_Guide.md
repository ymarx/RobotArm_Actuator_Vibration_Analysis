# ECMiner í†µí•© ê°€ì´ë“œ - ë¡œë´‡ ì•” ì•¡ì¶”ì—ì´í„° ì§„ë™ ë¶„ì„

**ì‘ì„±ì¼**: 2025-11-24
**í”„ë¡œì íŠ¸**: Robot Arm Actuator Vibration Analysis
**ìµœì¢… ëª¨ë¸**: XGBoost v3 (Test AUC 0.820)

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œìš”](#1-ê°œìš”)
2. [ECMiner 3-Stage íŒŒì´í”„ë¼ì¸](#2-ecminer-3-stage-íŒŒì´í”„ë¼ì¸)
3. [Stage 1: íŒŒì´ì¬ ì—°ë™ ë…¸ë“œ](#3-stage-1-íŒŒì´ì¬-ì—°ë™-ë…¸ë“œ)
4. [Stage 2: ECMiner ì „ì²˜ë¦¬](#4-stage-2-ecminer-ì „ì²˜ë¦¬)
5. [Stage 3: XGBoost ëª¨ë¸ë§](#5-stage-3-xgboost-ëª¨ë¸ë§)
6. [ë°ì´í„° ì¤€ë¹„](#6-ë°ì´í„°-ì¤€ë¹„)
7. [ì‹¤í–‰ ì ˆì°¨](#7-ì‹¤í–‰-ì ˆì°¨)
8. [ë¬¸ì œ í•´ê²°](#8-ë¬¸ì œ-í•´ê²°)

---

## 1. ê°œìš”

### 1.1 ëª©ì 

Python ì½”ë“œë¡œ êµ¬ì¶•í•œ **XGBoost v3 ëª¨ë¸ íŒŒì´í”„ë¼ì¸**ì„ ECMiner ë…¸ë“œ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì¬êµ¬í˜„í•˜ì—¬:
- ë…¸ì½”ë“œ í™˜ê²½ì—ì„œ ë™ì¼í•œ ë¶„ì„ ìˆ˜í–‰
- ECMinerì˜ GUI ê¸°ë°˜ ë¶„ì„ ì›Œí¬í”Œë¡œìš° í™œìš©
- íŒŒì´ì¬ ì—°ë™ ë…¸ë“œë¡œ ECMiner ë¯¸ì§€ì› ê¸°ëŠ¥ ë³´ì™„

### 1.2 í•µì‹¬ ì „ëµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ íŒŒì´ì¬ ì½”ë“œ í”„ë¡œì íŠ¸                                          â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚ Raw CSV â†’ Window Sliding â†’ Feature Extraction (18ê°œ)       â”‚
â”‚         â†’ Feature Selection (12ê°œ) â†’ XGBoost v3 í•™ìŠµ/ì˜ˆì¸¡   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“ ë³€í™˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ECMiner ë…¸ë“œ ìŠ¤íŠ¸ë¦¼                                           â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” â”‚
â”‚ [Stage1: íŒŒì´ì¬ ì—°ë™] â†’ [Stage2: Filter ë…¸ë“œ]               â”‚
â”‚                      â†’ [Stage3: XGBoost ë…¸ë“œ]               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ë¶„í•  ì›ì¹™**:
- **Stage 1 (Python)**: ECMinerë¡œ ë¶ˆê°€ëŠ¥í•œ ì‘ì—… (ìœˆë„ìš° ìŠ¬ë¼ì´ë”©, FFT, Band RMS)
- **Stage 2 (ECMiner)**: ECMiner ë…¸ë“œë¡œ ê°€ëŠ¥í•œ ì „ì²˜ë¦¬ (Filter, Normalization)
- **Stage 3 (ECMiner)**: ëª¨ë¸ë§ (XGBoost í•™ìŠµ/ì˜ˆì¸¡)

---

## 2. ECMiner 3-Stage íŒŒì´í”„ë¼ì¸

### 2.1 ì „ì²´ êµ¬ì¡°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 1: íŒŒì´ì¬ ì—°ë™ ë…¸ë“œ (Feature Extraction)               â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ìŠ¤í¬ë¦½íŠ¸: ecminer_stage1_feature_extraction.py               â”‚
â”‚                                                               â”‚
â”‚ ì…ë ¥ (ecmData):                                               â”‚
â”‚   - file_path: Raw CSV ê²½ë¡œ                                   â”‚
â”‚   - label: Normal=1, Abnormal=0                               â”‚
â”‚   - dataset_type: 'train' or 'test'                          â”‚
â”‚                                                               â”‚
â”‚ ì²˜ë¦¬:                                                          â”‚
â”‚   1. CSV íŒŒì‹± (ë©”íƒ€ë°ì´í„° + ì‹œê³„ì—´)                           â”‚
â”‚   2. ìœˆë„ìš° ìŠ¬ë¼ì´ë”© (8ì´ˆ, 50% ì˜¤ë²„ë©)                        â”‚
â”‚   3. 18ê°œ íŠ¹ì„± ì¶”ì¶œ:                                           â”‚
â”‚      - ê¸°ë³¸ 9ê°œ: RMS(4), Peak(2), Crest(1), Kurtosis(2)      â”‚
â”‚      - Band RMS 9ê°œ: low/mid/high Ã— acc_Y/acc_Sum/Gyro_Y    â”‚
â”‚                                                               â”‚
â”‚ ì¶œë ¥ (ecmData):                                               â”‚
â”‚   - ìœˆë„ìš° Ã— (18ê°œ íŠ¹ì„± + ë©”íƒ€ ì»¬ëŸ¼)                          â”‚
â”‚   - 2D Tabular ë°ì´í„° (CSV/DataFrame)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 2: ECMiner ì „ì²˜ë¦¬ ë…¸ë“œ                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ë…¸ë“œ êµ¬ì„±:                                                     â”‚
â”‚   1. Filter ë…¸ë“œ: 18ê°œ â†’ 12ê°œ íŠ¹ì„± ì„ íƒ                       â”‚
â”‚      ì„ íƒ íŠ¹ì„± (XGBoost v3):                                   â”‚
â”‚        - acc_Y_rms, acc_X_rms, Gyro_Y_rms, Gyro_X_rms        â”‚
â”‚        - acc_Y_peak, acc_Sum_peak                             â”‚
â”‚        - acc_Y_crest                                          â”‚
â”‚        - acc_Y_kurtosis, acc_Sum_kurtosis                     â”‚
â”‚        - acc_Y_rms_high, Gyro_Y_rms_high, Gyro_Y_rms_low     â”‚
â”‚                                                               â”‚
â”‚   2. (ì„ íƒ) Normalization ë…¸ë“œ                                â”‚
â”‚   3. (ì„ íƒ) Outlier ì²˜ë¦¬ ë…¸ë“œ                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Stage 3: ECMiner XGBoost ëª¨ë¸ë§ ë…¸ë“œ                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Train ìŠ¤íŠ¸ë¦¼:                                                  â”‚
â”‚   - Input: dataset_type='train' í•„í„°ë§ëœ ë°ì´í„°               â”‚
â”‚   - XGBoost íŒŒë¼ë¯¸í„°:                                          â”‚
â”‚     * max_depth: 3                                            â”‚
â”‚     * min_child_weight: 5                                     â”‚
â”‚     * learning_rate: 0.05-0.1                                 â”‚
â”‚     * reg_lambda: 5                                           â”‚
â”‚     * reg_alpha: 1                                            â”‚
â”‚     * scale_pos_weight: 0.88                                  â”‚
â”‚   - ì¶œë ¥: í•™ìŠµëœ ëª¨ë¸ ì €ì¥                                     â”‚
â”‚                                                               â”‚
â”‚ Test ìŠ¤íŠ¸ë¦¼:                                                   â”‚
â”‚   - Input: dataset_type='test' í•„í„°ë§ëœ ë°ì´í„°                â”‚
â”‚   - í•™ìŠµëœ ëª¨ë¸ ë¡œë“œ                                           â”‚
â”‚   - ì˜ˆì¸¡ ìˆ˜í–‰ â†’ AUC, Confusion Matrix, Classification Report â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ë°ì´í„° íë¦„

```
Raw CSV íŒŒì¼ (57ê°œ)
    â†“ [Stage1: Python]
ìœˆë„ìš° í…Œì´ë¸” (898 rows Ã— 28 columns)
    - 18ê°œ íŠ¹ì„±
    - 10ê°œ ë©”íƒ€ ì»¬ëŸ¼ (file_id, window_idx, label, dataset_type, ...)
    â†“ [Stage2: Filter]
ì„ íƒ íŠ¹ì„± í…Œì´ë¸” (898 rows Ã— 12 features + meta)
    â†“ [Stage3: XGBoost]
ëª¨ë¸ í•™ìŠµ (Train) / ì˜ˆì¸¡ (Test)
    - Train: 695 ìœˆë„ìš° â†’ ëª¨ë¸ ì €ì¥
    - Test: 111 ìœˆë„ìš° â†’ ì„±ëŠ¥ í‰ê°€ (AUC 0.820 ëª©í‘œ)
```

---

## 3. Stage 1: íŒŒì´ì¬ ì—°ë™ ë…¸ë“œ

### 3.1 ìŠ¤í¬ë¦½íŠ¸ ê°œìš”

**íŒŒì¼**: `ecminer_stage1_feature_extraction.py`

**ì—­í• **:
1. ECMinerë¡œ êµ¬í˜„ ë¶ˆê°€ëŠ¥í•œ ì „ì²˜ë¦¬
2. ë‹¤ì°¨ì› ì‹œê³„ì—´ â†’ 2D Tabular ë³€í™˜
3. 18ê°œ íŠ¹ì„± ì¶”ì¶œ (FFT ê¸°ë°˜ Band RMS í¬í•¨)

### 3.2 ì…ë ¥ ë°ì´í„° í˜•ì‹ (ecmData)

ECMiner ìƒìœ„ ë…¸ë“œì—ì„œ ë‹¤ìŒ í˜•ì‹ì˜ DataFrameì„ ì¤€ë¹„í•´ì•¼ í•©ë‹ˆë‹¤:

| file_path | label | dataset_type | file_id (optional) |
|-----------|-------|--------------|-------------------|
| `/path/to/100W_Sample00_ccw4.csv` | 1 | train | 100W_S00_CCW_R4 |
| `/path/to/100W_Sample03_cw4.csv` | 0 | train | 100W_S03_CW_R4 |
| `/path/to/200W_Sample02_cw4.csv` | 1 | test | 200W_S02_CW_R4 |

**í•„ìˆ˜ ì»¬ëŸ¼**:
- `file_path` (str): Raw CSV íŒŒì¼ì˜ ì ˆëŒ€ ê²½ë¡œ
- `label` (int): íŒŒì¼ ë ˆë²¨ ë ˆì´ë¸” (Normal=1, Abnormal=0)
- `dataset_type` (str): `'train'` ë˜ëŠ” `'test'`

**ì„ íƒ ì»¬ëŸ¼**:
- `file_id` (str): íŒŒì¼ ê³ ìœ  ID (ì—†ìœ¼ë©´ ë©”íƒ€ë°ì´í„°ì—ì„œ ìë™ ìƒì„±)

### 3.3 ì¶œë ¥ ë°ì´í„° í˜•ì‹ (ecmData)

ìœˆë„ìš° ë‹¨ìœ„ Feature Table (2D DataFrame):

**ë©”íƒ€ ì»¬ëŸ¼ (10ê°œ)**:
- `file_id`: íŒŒì¼ ê³ ìœ  ID (ì˜ˆ: `100W_S03_CW_R4`)
- `window_idx`: ìœˆë„ìš° ì¸ë±ìŠ¤ (íŒŒì¼ ë‚´ ìˆœì„œ)
- `start_idx`, `end_idx`: ìœˆë„ìš° ìƒ˜í”Œ ì¸ë±ìŠ¤
- `label`: ë ˆì´ë¸” (Normal=1, Abnormal=0)
- `dataset_type`: `'train'` or `'test'`
- `product`: ì œí’ˆ (100W, 200W)
- `serial`: ì‹œë¦¬ì–¼ (Sample03 cw4)
- `condition`: ì¸¡ì • ì¡°ê±´ (CW4, CCW4)
- `load`: ë¶€í•˜ ì •ë³´

**íŠ¹ì„± ì»¬ëŸ¼ (18ê°œ)**:

| ì¹´í…Œê³ ë¦¬ | íŠ¹ì„± ì´ë¦„ | ì„¤ëª… |
|---------|----------|------|
| **ê¸°ë³¸ RMS (4ê°œ)** | `acc_Y_rms`, `acc_X_rms` | ê°€ì†ë„ RMS |
|  | `Gyro_Y_rms`, `Gyro_X_rms` | ìì´ë¡œ RMS |
| **Peak (2ê°œ)** | `acc_Y_peak`, `acc_Sum_peak` | Peak ê°’ |
| **Crest Factor (1ê°œ)** | `acc_Y_crest` | Peak/RMS |
| **Kurtosis (2ê°œ)** | `acc_Y_kurtosis`, `acc_Sum_kurtosis` | ë¶„í¬ ì²¨ë„ |
| **Band RMS - acc_Y (3ê°œ)** | `acc_Y_rms_low` (1-10 Hz) | ì €ì£¼íŒŒ |
|  | `acc_Y_rms_mid` (10-50 Hz) | ì¤‘ì£¼íŒŒ |
|  | `acc_Y_rms_high` (50-150 Hz) | ê³ ì£¼íŒŒ |
| **Band RMS - acc_Sum (3ê°œ)** | `acc_Sum_rms_low/mid/high` | ë²¡í„°í•© ëŒ€ì—­ RMS |
| **Band RMS - Gyro_Y (3ê°œ)** | `Gyro_Y_rms_low/mid/high` | ìì´ë¡œ ëŒ€ì—­ RMS |

### 3.4 í•µì‹¬ ì•Œê³ ë¦¬ì¦˜

#### ìœˆë„ìš° ìŠ¬ë¼ì´ë”©

```python
# ì„¤ì •
FS = 512  # ìƒ˜í”Œë§ ë ˆì´íŠ¸ [Hz]
WINDOW_SEC = 8.0  # ìœˆë„ìš° ê¸¸ì´ [ì´ˆ]
WINDOW_SIZE = 4096  # ìƒ˜í”Œ ìˆ˜
WINDOW_STEP = 2048  # 50% ì˜¤ë²„ë©

# ìŠ¬ë¼ì´ë”©
start = 0
while start + WINDOW_SIZE <= n_samples:
    end = start + WINDOW_SIZE
    window_data = data[start:end]
    # ... íŠ¹ì„± ì¶”ì¶œ
    start += WINDOW_STEP  # 4ì´ˆì”© ì´ë™
```

#### Band RMS ê³„ì‚° (Butterworth í•„í„°)

```python
# 1. Butterworth 4ì°¨ bandpass filter ì„¤ê³„
b, a = signal.butter(4, [f_low/nyquist, f_high/nyquist], btype='band')

# 2. Zero-phase filtering (filtfilt)
filtered_signal = signal.filtfilt(b, a, signal_data)

# 3. RMS ê³„ì‚°
band_rms = sqrt(mean(filtered_signal ** 2))

# 4. ì‹¤íŒ¨ ì‹œ FFT í´ë°±
# (ìë™ ì²˜ë¦¬)
```

### 3.5 ECMinerì—ì„œ ë…¸ë“œ ì„¤ì •

1. **íŒŒì´ì¬ ì—°ë™ ë…¸ë“œ ìƒì„±**
   - ë…¸ë“œ íƒ€ì…: `Python Script`
   - ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼: `ecminer_stage1_feature_extraction.py` ì„ íƒ

2. **ì…ë ¥ ì—°ê²°**
   - ìƒìœ„ ë…¸ë“œ: CSV ë¦¬ìŠ¤íŠ¸ ìƒì„± ë…¸ë“œ (file_path, label, dataset_type ì»¬ëŸ¼)
   - ì—°ê²°: ìƒìœ„ ë…¸ë“œ ì¶œë ¥ â†’ Python Script ì…ë ¥ (`ecmData`)

3. **ì¶œë ¥ í™•ì¸**
   - ì¶œë ¥ í¬íŠ¸: `ecmData` (ìœˆë„ìš° Feature Table)
   - ë‹¤ìŒ ë…¸ë“œë¡œ ì „ë‹¬: Filter ë…¸ë“œ

---

## 4. Stage 2: ECMiner ì „ì²˜ë¦¬

### 4.1 Filter ë…¸ë“œ (íŠ¹ì„± ì„ íƒ)

**ëª©ì **: 18ê°œ â†’ 12ê°œ íŠ¹ì„± ì„ íƒ (XGBoost v3)

**ECMiner ì„¤ì •**:
1. **ë…¸ë“œ ì¶”ê°€**: `Filter` ë…¸ë“œ
2. **ì…ë ¥**: Stage1 Python ë…¸ë“œ ì¶œë ¥
3. **ì„ íƒ ì»¬ëŸ¼** (12ê°œ):
   ```
   acc_Y_rms
   acc_X_rms
   Gyro_Y_rms
   Gyro_X_rms
   acc_Y_peak
   acc_Sum_peak
   acc_Y_crest
   acc_Y_kurtosis
   acc_Sum_kurtosis
   acc_Y_rms_high
   Gyro_Y_rms_high
   Gyro_Y_rms_low
   ```
4. **ì œì™¸ ì»¬ëŸ¼** (6ê°œ):
   - `acc_Sum_rms_low`, `acc_Sum_rms_mid`, `acc_Sum_rms_high`
   - `acc_Y_rms_mid`, `Gyro_Y_rms_mid`
   - (ë©”íƒ€ ì»¬ëŸ¼ì€ ìœ ì§€)

### 4.2 (ì„ íƒ) ì¶”ê°€ ì „ì²˜ë¦¬ ë…¸ë“œ

**Normalization ë…¸ë“œ**:
- ë°©ë²•: StandardScaler (í‰ê·  0, í‘œì¤€í¸ì°¨ 1)
- ì ìš© ë²”ìœ„: 12ê°œ íŠ¹ì„± ì»¬ëŸ¼ë§Œ
- ì£¼ì˜: Train ì„¸íŠ¸ í†µê³„ë¡œ í•™ìŠµ í›„ Testì— ë™ì¼ ì ìš©

**Outlier ì²˜ë¦¬ ë…¸ë“œ**:
- ë°©ë²•: IQR (Interquartile Range)
- Threshold: 1.5 Ã— IQR
- ì²˜ë¦¬: ì œê±° ë˜ëŠ” Clipping

**ê¶Œì¥ì‚¬í•­**:
- í”„ë¡œì íŠ¸ ì½”ë“œëŠ” ì •ê·œí™” ì—†ì´ AUC 0.820 ë‹¬ì„±
- ì¶”ê°€ ì „ì²˜ë¦¬ëŠ” ì„ íƒ ì‚¬í•­ (ì„±ëŠ¥ ê°œì„  ì‹¤í—˜)

---

## 5. Stage 3: XGBoost ëª¨ë¸ë§

### 5.1 Train ìŠ¤íŠ¸ë¦¼

**ë…¸ë“œ êµ¬ì„±**:
1. **Filter ë…¸ë“œ**: `dataset_type == 'train'` ì¡°ê±´ìœ¼ë¡œ Train ë°ì´í„°ë§Œ ì„ íƒ
2. **XGBoost ë…¸ë“œ**: ëª¨ë¸ í•™ìŠµ

**XGBoost íŒŒë¼ë¯¸í„°** (í”„ë¡œì íŠ¸ ê²€ì¦ê°’):

| íŒŒë¼ë¯¸í„° | ê°’ | ì„¤ëª… |
|---------|----|----|
| `max_depth` | 3 | íŠ¸ë¦¬ ìµœëŒ€ ê¹Šì´ |
| `min_child_weight` | 5 | ë¦¬í”„ ë…¸ë“œ ìµœì†Œ ìƒ˜í”Œ ê°€ì¤‘ì¹˜ í•© |
| `learning_rate` | 0.05-0.1 | í•™ìŠµë¥  (ì‘ì„ìˆ˜ë¡ ì•ˆì •) |
| `n_estimators` | 100-200 | íŠ¸ë¦¬ ê°œìˆ˜ |
| `subsample` | 0.8 | ìƒ˜í”Œ ìƒ˜í”Œë§ ë¹„ìœ¨ |
| `colsample_bytree` | 0.8 | íŠ¹ì„± ìƒ˜í”Œë§ ë¹„ìœ¨ |
| `reg_lambda` | 5 | L2 ì •ê·œí™” (Ridge) |
| `reg_alpha` | 1 | L1 ì •ê·œí™” (Lasso) |
| `scale_pos_weight` | 0.88 | í´ë˜ìŠ¤ ê°€ì¤‘ì¹˜ (Abnormal/Normal) |

**ECMiner ë¯¸ì§€ì› íŒŒë¼ë¯¸í„° ëŒ€ì‘**:
- `scale_pos_weight`: ìˆ˜ë™ ì„¤ì • ë¶ˆê°€ ì‹œ â†’ `learning_rate`, `max_depth` ì¡°ì •
- `reg_alpha`: ë¯¸ì§€ì› ì‹œ â†’ `reg_lambda` ì¦ê°€ (L2ë§Œ ì‚¬ìš©)

**ëª¨ë¸ ì €ì¥**:
- ECMiner í”„ë¡œì íŠ¸ ë‚´ ëª¨ë¸ íŒŒì¼ ì €ì¥
- íŒŒì¼ëª…: `xgboost_v3_ecminer.model`

### 5.2 Test ìŠ¤íŠ¸ë¦¼

**ë…¸ë“œ êµ¬ì„±**:
1. **Filter ë…¸ë“œ**: `dataset_type == 'test'` ì¡°ê±´ìœ¼ë¡œ Test ë°ì´í„°ë§Œ ì„ íƒ
2. **XGBoost Predict ë…¸ë“œ**: í•™ìŠµëœ ëª¨ë¸ ë¡œë“œ ë° ì˜ˆì¸¡

**í‰ê°€ ì§€í‘œ**:
- **AUC**: 0.820 ëª©í‘œ (í”„ë¡œì íŠ¸ ê²€ì¦ê°’)
- **Accuracy**: ~79%
- **Abnormal Recall**: 0.804 (80% ë¶ˆëŸ‰í’ˆ ê°ì§€)
- **Abnormal Precision**: 0.951 (ì˜¤íƒ 5%)
- **Normal Recall**: 0.714 (71% ì •ìƒí’ˆ ê°ì§€)

**Confusion Matrix ì˜ˆìƒ**:
```
              ì˜ˆì¸¡
            Abn   Norm
ì‹¤ì œ Abn     78    19
     Norm     4    10
```

---

## 6. ë°ì´í„° ì¤€ë¹„

### 6.1 ì›ë³¸ CSV íŒŒì¼ êµ¬ì¡°

**ìœ„ì¹˜**: í”„ë¡œì íŠ¸ ë£¨íŠ¸ì˜ `100W/`, `200W/` í´ë”

**íŒŒì¼ëª… ì˜ˆì‹œ**:
```
100W_Sample00 ccw4_2025-11-07 03-43-20.csv
200W_Sample03 cw4_2025-11-07 03-34-02.csv
```

**CSV ë‚´ë¶€ êµ¬ì¡°**:
```
Product,100W
Serial,Sample00 ccw4
Condition,CCW4
Load,
Resampling,512
Speed,

DataSet
TimeStamp,acc-X,acc-Y,acc-Z,Gyro-X,Gyro-Y,Gyro-Z,acc-Sum
0,0.123,0.456,...
1,0.234,0.567,...
...
```

**í•„ìˆ˜ í™•ì¸ì‚¬í•­**:
- `DataSet` ë§ˆì»¤ ì¡´ì¬
- ì´í›„ í—¤ë”: `TimeStamp,acc-X,acc-Y,acc-Z,Gyro-X,Gyro-Y,Gyro-Z,acc-Sum`
- ìƒ˜í”Œë§ ë ˆì´íŠ¸: 512 Hz (ë©”íƒ€ë°ì´í„° `Resampling`)

### 6.2 íŒŒì¼ ëª©ë¡ ì¤€ë¹„ (ecmData ì…ë ¥)

ECMinerì—ì„œ ë‹¤ìŒ ë°©ë²•ìœ¼ë¡œ íŒŒì¼ ë¦¬ìŠ¤íŠ¸ ìƒì„±:

**ë°©ë²• 1: CSV íŒŒì¼ë¡œ ìˆ˜ë™ ì‘ì„±**

íŒŒì¼: `file_list.csv`
```csv
file_path,label,dataset_type
/path/to/100W/100W_Sample00 ccw4.csv,1,train
/path/to/100W/100W_S01_CCW_R4.csv,1,train
/path/to/100W/100W_S03_CW_R4.csv,0,test
/path/to/200W/200W_S02_CW_R4.csv,1,train
...
```

**ë°©ë²• 2: ECMiner File List ë…¸ë“œ**

1. `File List` ë…¸ë“œ ì¶”ê°€
2. ë””ë ‰í† ë¦¬ ì„ íƒ: `100W/`, `200W/`
3. í•„í„°: `*.csv`
4. ì¶œë ¥: `file_path` ì»¬ëŸ¼
5. `Add Column` ë…¸ë“œë¡œ `label`, `dataset_type` ì¶”ê°€

### 6.3 ë ˆì´ë¸” í• ë‹¹ ê·œì¹™

**í”„ë¡œì íŠ¸ ê²€ì¦ ê²°ê³¼**:

| ì œí’ˆ | ì‹œë£Œ | CW | CCW | ë ˆì´ë¸” | ë¹„ê³  |
|------|------|----|-----|-------|------|
| 100W | S00 | âœ… | âœ… | Normal (1) | Train (ì‹œê°„ë¶„í• ) |
| 100W | S01 | âœ… | âœ… | Normal (1) | Train (íŒŒì¼ë¶„í• ) |
| 100W | S05 | âœ… | âœ… | Normal (1) | Train (íŒŒì¼ë¶„í• ) |
| 100W | S06 | âœ… | âœ… | Normal (1) | Train (íŒŒì¼ë¶„í• ) |
| 200W | S02 | âœ… | âŒ | Normal (1) | Train (íŒŒì¼ë¶„í• ) |
| 200W | S03 | âœ… | âœ… | Normal (1) | Test (ì‹œê°„ë¶„í• ) |
| **ê¸°íƒ€** | **ì „ì²´** | - | - | **Abnormal (0)** | Train/Test í˜¼í•© |

**Train/Test ë¶„í•  ê¶Œì¥**:
- Train: 695 ìœˆë„ìš° (ì•½ 77%)
- Test: 111 ìœˆë„ìš° (ì•½ 13%)
- Validationì€ ECMinerì—ì„œ ë¶ˆí•„ìš” (CV ì—†ìŒ)

---

## 7. ì‹¤í–‰ ì ˆì°¨

### 7.1 Step-by-Step ê°€ì´ë“œ

#### **Step 1: íŒŒì¼ ëª©ë¡ ì¤€ë¹„**

1. `file_list.csv` ì‘ì„± ë˜ëŠ” ECMiner `File List` ë…¸ë“œ ì‚¬ìš©
2. í•„ìˆ˜ ì»¬ëŸ¼ í™•ì¸: `file_path`, `label`, `dataset_type`
3. ê²½ë¡œ í™•ì¸: ëª¨ë“  CSV íŒŒì¼ì´ ì ‘ê·¼ ê°€ëŠ¥í•œì§€ ê²€ì¦

#### **Step 2: Stage 1 - íŒŒì´ì¬ ì—°ë™ ë…¸ë“œ**

1. ECMiner í”„ë¡œì íŠ¸ ìƒì„±
2. `Import` ë…¸ë“œ ì¶”ê°€ â†’ `file_list.csv` ë¡œë“œ
3. `Python Script` ë…¸ë“œ ì¶”ê°€
   - ìŠ¤í¬ë¦½íŠ¸: `ecminer_stage1_feature_extraction.py` ì„ íƒ
   - ì…ë ¥ ì—°ê²°: Import ë…¸ë“œ â†’ Python Script ë…¸ë“œ
4. ì‹¤í–‰ ë° ì¶œë ¥ í™•ì¸
   - ì˜ˆìƒ ì¶œë ¥: 898 rows Ã— 28 columns
   - ì»¬ëŸ¼ í™•ì¸: 18ê°œ íŠ¹ì„± + 10ê°œ ë©”íƒ€

#### **Step 3: Stage 2 - ì „ì²˜ë¦¬**

1. `Filter` ë…¸ë“œ ì¶”ê°€
   - ì…ë ¥: Python Script ë…¸ë“œ ì¶œë ¥
   - ì„ íƒ ì»¬ëŸ¼: 12ê°œ íŠ¹ì„± (ìœ„ 4.1 ì°¸ì¡°)
2. (ì„ íƒ) `Normalization` ë…¸ë“œ ì¶”ê°€
3. ì‹¤í–‰ ë° í™•ì¸
   - ì˜ˆìƒ ì¶œë ¥: 898 rows Ã— (12 features + meta)

#### **Step 4: Stage 3 - ëª¨ë¸ë§ (Train)**

1. `Filter` ë…¸ë“œ ì¶”ê°€ (ì¡°ê±´: `dataset_type == 'train'`)
2. `XGBoost` ë…¸ë“œ ì¶”ê°€
   - ì…ë ¥: í•„í„°ë§ëœ Train ë°ì´í„°
   - íŒŒë¼ë¯¸í„°: ìœ„ 5.1 ì°¸ì¡°
   - Target ì»¬ëŸ¼: `label`
   - Feature ì»¬ëŸ¼: 12ê°œ íŠ¹ì„±
3. í•™ìŠµ ì‹¤í–‰
4. ëª¨ë¸ ì €ì¥ í™•ì¸

#### **Step 5: Stage 3 - ëª¨ë¸ë§ (Test)**

1. `Filter` ë…¸ë“œ ì¶”ê°€ (ì¡°ê±´: `dataset_type == 'test'`)
2. `XGBoost Predict` ë…¸ë“œ ì¶”ê°€
   - ì…ë ¥: í•„í„°ë§ëœ Test ë°ì´í„°
   - ëª¨ë¸: Step 4ì—ì„œ ì €ì¥í•œ ëª¨ë¸ ë¡œë“œ
3. ì˜ˆì¸¡ ì‹¤í–‰
4. í‰ê°€ ì§€í‘œ í™•ì¸:
   - AUC â‰ˆ 0.820
   - Accuracy â‰ˆ 0.79
   - Confusion Matrix í™•ì¸

### 7.2 ì „ì²´ ë…¸ë“œ ìŠ¤íŠ¸ë¦¼ êµ¬ì¡°

```
[Import: file_list.csv]
        â†“
[Python Script: Stage1]
        â†“
[Filter: 18â†’12 features]
        â†“
    â”Œâ”€â”€â”€â”´â”€â”€â”€â”
    â†“       â†“
[Filter:    [Filter:
 Train]     Test]
    â†“       â†“
[XGBoost]  [XGBoost
 Training]  Predict]
    â†“       â†“
[Save      [Evaluate
 Model]     AUC, CM]
```

---

## 8. ë¬¸ì œ í•´ê²°

### 8.1 ì¼ë°˜ì ì¸ ì˜¤ë¥˜

#### **ì˜¤ë¥˜ 1: "file_pathë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"**

**ì¦ìƒ**: íŒŒì´ì¬ ìŠ¤í¬ë¦½íŠ¸ì—ì„œ CSV íŒŒì¼ ì½ê¸° ì‹¤íŒ¨

**ì›ì¸**:
- ê²½ë¡œê°€ ìƒëŒ€ ê²½ë¡œë¡œ ì§€ì •ë¨
- íŒŒì¼ì´ ì‹¤ì œë¡œ ì¡´ì¬í•˜ì§€ ì•ŠìŒ

**í•´ê²°**:
```python
# file_list.csvì—ì„œ ì ˆëŒ€ ê²½ë¡œ ì‚¬ìš©
# ì˜ˆ: /Users/YMARX/Dropbox/.../100W_S00_CCW.csv

# ë˜ëŠ” ECMiner í”„ë¡œì íŠ¸ í´ë” ê¸°ì¤€ ìƒëŒ€ ê²½ë¡œ
# ì˜ˆ: ./data/100W/100W_S00_CCW.csv
```

#### **ì˜¤ë¥˜ 2: "DataSet ë§ˆì»¤ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤"**

**ì¦ìƒ**: `ValueError: í—¤ë” ë¼ì¸ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤`

**ì›ì¸**: CSV íŒŒì¼ í˜•ì‹ì´ í”„ë¡œì íŠ¸ í˜•ì‹ê³¼ ë‹¤ë¦„

**í•´ê²°**:
1. CSV íŒŒì¼ ì—´ì–´ì„œ `DataSet` ì¤„ í™•ì¸
2. ì—†ìœ¼ë©´ ìˆ˜ë™ìœ¼ë¡œ ì¶”ê°€í•˜ê±°ë‚˜ ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •
3. ëŒ€ì†Œë¬¸ì í™•ì¸ (`dataset` vs `DataSet`)

#### **ì˜¤ë¥˜ 3: "Band RMS ê³„ì‚° ì‹¤íŒ¨"**

**ì¦ìƒ**: `Filter design failed for band...` ê²½ê³ 

**ì›ì¸**:
- ìœˆë„ìš° ìƒ˜í”Œ ìˆ˜ ë¶€ì¡± (< 100ê°œ)
- ì£¼íŒŒìˆ˜ ëŒ€ì—­ì´ Nyquist ì£¼íŒŒìˆ˜ ì´ˆê³¼

**í•´ê²°**:
- ìë™ìœ¼ë¡œ FFT í´ë°± ì‚¬ìš© (ì •ìƒ ë™ì‘)
- ê²½ê³ ë§Œ ì¶œë ¥ë˜ê³  RMS ê°’ì€ ê³„ì‚°ë¨

#### **ì˜¤ë¥˜ 4: "íŠ¹ì„± ê°œìˆ˜ ë¶ˆì¼ì¹˜"**

**ì¦ìƒ**: Filter ë…¸ë“œì—ì„œ 12ê°œ íŠ¹ì„± ì„ íƒ ë¶ˆê°€

**ì›ì¸**: Python ë…¸ë“œ ì¶œë ¥ì— 18ê°œ íŠ¹ì„±ì´ ì—†ìŒ

**í•´ê²°**:
1. Python ë…¸ë“œ ì¶œë ¥ í™•ì¸ (ì»¬ëŸ¼ ë¦¬ìŠ¤íŠ¸)
2. ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ë¡œê·¸ í™•ì¸
3. íŠ¹ì„± ì´ë¦„ ì² ì í™•ì¸ (`acc_Y_rms` vs `acc-Y-rms`)

### 8.2 ì„±ëŠ¥ ë¬¸ì œ

#### **ì²˜ë¦¬ ì†ë„ ëŠë¦¼**

**ì›ì¸**: Band RMS ê³„ì‚° (FFT/í•„í„°ë§)ì´ ì‹œê°„ ì†Œëª¨

**í•´ê²°**:
- íŒŒì¼ ìˆ˜ë¥¼ ì¤„ì—¬ì„œ í…ŒìŠ¤íŠ¸ (5-10ê°œ)
- ìœˆë„ìš° ì˜¤ë²„ë© ê°ì†Œ (50% â†’ 25%)
- Band RMS íŠ¹ì„± ì œê±° (9ê°œ â†’ 0ê°œ, ê¸°ë³¸ 9ê°œë§Œ ì‚¬ìš©)

#### **ë©”ëª¨ë¦¬ ë¶€ì¡±**

**ì›ì¸**: 898ê°œ ìœˆë„ìš° Ã— 28ê°œ ì»¬ëŸ¼ + ì›ë³¸ CSV ìºì‹±

**í•´ê²°**:
- íŒŒì¼ì„ ë°°ì¹˜ë¡œ ì²˜ë¦¬ (ì˜ˆ: 10ê°œì”©)
- ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •: íŒŒì¼ë³„ ì²˜ë¦¬ í›„ ì¦‰ì‹œ ì €ì¥ (ë©”ëª¨ë¦¬ í•´ì œ)

### 8.3 ê²°ê³¼ ê²€ì¦

#### **AUCê°€ 0.820ë³´ë‹¤ ë‚®ìŒ**

**ì›ì¸**:
1. ECMiner XGBoost íŒŒë¼ë¯¸í„°ê°€ í”„ë¡œì íŠ¸ì™€ ë‹¤ë¦„
2. Train/Test ë°ì´í„° ë¶„í• ì´ ë‹¤ë¦„
3. ì •ê·œí™”/ì „ì²˜ë¦¬ ì°¨ì´

**í•´ê²°**:
1. íŒŒë¼ë¯¸í„° ì¬í™•ì¸ (íŠ¹íˆ `max_depth=3`, `reg_lambda=5`)
2. Train/Test ë¶„í•  í™•ì¸ (Train 695, Test 111)
3. ì •ê·œí™” ì œê±° (í”„ë¡œì íŠ¸ëŠ” ë¯¸ì‚¬ìš©)

#### **Abnormal Recallì´ ë‚®ìŒ**

**ì›ì¸**: Threshold ì„¤ì • (ê¸°ë³¸ 0.5)

**í•´ê²°**:
- ECMiner XGBoost ë…¸ë“œì—ì„œ Threshold ì¡°ì • (0.4-0.5)
- í”„ë¡œì íŠ¸ëŠ” Threshold 0.5ë¡œ Recall 0.804 ë‹¬ì„±

---

## 9. ì¶”ê°€ ìë£Œ

### 9.1 í”„ë¡œì íŠ¸ ë¬¸ì„œ

- `í”„ë¡œì íŠ¸_ì¢…í•©_ë¶„ì„_ë³´ê³ ì„œ.md`: ì „ì²´ í”„ë¡œì íŠ¸ ìš”ì•½
- `ë°ì´í„°_ë¶„í• _ë°©ë²•ë¡ _ì„¤ëª…ì„œ.md`: ìœˆë„ìš° ìŠ¬ë¼ì´ë”©, Train/Test ë¶„í•  ìƒì„¸
- `SESSION_SUMMARY_Phase3.md`: Phase 3 ì„¸ì…˜ ìš”ì•½

### 9.2 í”„ë¡œì íŠ¸ ì½”ë“œ ì°¸ì¡°

- `scripts/step3_3_add_band_rms.py`: Band RMS ì¶”ì¶œ ì›ë³¸
- `phase3/phase3_1_xgboost_core_band_rms.py`: XGBoost v3 í•™ìŠµ ì½”ë“œ
- `src/preprocess/segment.py`: ìœˆë„ìš° ìŠ¬ë¼ì´ë”© ë¡œì§
- `src/features/time_domain.py`: ê¸°ë³¸ íŠ¹ì„± ì¶”ì¶œ í•¨ìˆ˜

### 9.3 ECMiner ì„¤ëª…ì„œ

- `ECMiner_ì„¤ëª…ì„œ(ë°œì·Œ)/`: ECMiner ë…¸ë“œ ì‚¬ìš©ë²•
- íŒŒì´ì¬ ì—°ë™ ë…¸ë“œ ì‚¬ìš©ë²•
- XGBoost ë…¸ë“œ íŒŒë¼ë¯¸í„° ì„¤ì •

---

**ì‘ì„±ì**: Claude Code
**ê²€í† ì¼**: 2025-11-24
**ë²„ì „**: 1.0
