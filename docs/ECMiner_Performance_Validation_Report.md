# ECMiner Stage1 μ„±λ¥ κ²€μ¦ λ³΄κ³ μ„

**μ‘μ„±μΌ**: 2025-11-24
**λ©μ **: ECMiner XGBoost 4κ°€μ§€ νλΌλ―Έν„°λ΅ Phase3 μ„±λ¥ μ¬ν„ κ²€μ¦

---

## 1. κ²€μ¦ κ°μ”

### 1.1 κ²€μ¦ λ©μ 

ECMinerλ” XGBoost ν•™μµ μ‹ λ‹¤μ **4κ°€μ§€ ν•μ΄νΌνλΌλ―Έν„°λ§ μ΅°μ • κ°€λ¥**ν•©λ‹λ‹¤:

1. **μ΄ λ‚λ¬΄ μ** (n_estimators)
2. **μµλ€ νΈλ¦¬ κΉμ΄** (max_depth)
3. **μƒν”λ§ λΉ„μ¨** (subsample)
4. **ν•™μµλ¥ ** (learning_rate)

**Phase3μ—μ„ μ‚¬μ©ν• μ¶”κ°€ μ •κ·ν™” νλΌλ―Έν„°**λ” ECMinerμ—μ„ μ΅°μ •ν•  μ μ—†μµλ‹λ‹¤:
- `min_child_weight` = 5 (λ¦¬ν”„ λ…Έλ“ μµμ† κ°€μ¤‘μΉ)
- `reg_lambda` = 5 (L2 μ •κ·ν™”)
- `reg_alpha` = 1 (L1 μ •κ·ν™”)

β†’ **κ²€μ¦ μ§λ¬Έ**: ECMinerμ 4κ°€μ§€ νλΌλ―Έν„°λ§μΌλ΅λ„ Phase3 μμ¤€μ μ„±λ¥(AUC 0.820)μ„ λ‹¬μ„±ν•  μ μλ”κ°€?

### 1.2 κ²€μ¦ λ°©λ²•

**Phase3 μ›λ³Έ λ°μ΄ν„° μ‚¬μ©** (898 windows, 12 features):
- Train: 686 windows (Normal 365, Abnormal 321)
- Val: 92 windows (Normal 4, Abnormal 88)
- Test: 111 windows (Normal 14, Abnormal 97)

**3κ°€μ§€ XGBoost μ„¤μ • λΉ„κµ**:
1. **Phase3 Full**: 4κ°€μ§€ ECMiner νλΌλ―Έν„° + 3κ°€μ§€ μ •κ·ν™” νλΌλ―Έν„°
2. **ECMiner Only**: 4κ°€μ§€ ECMiner νλΌλ―Έν„°λ§
3. **ECMiner + colsample**: 5κ°€μ§€ νλΌλ―Έν„° (colsample_bytree μ¶”κ°€)

---

## 2. κ²€μ¦ κ²°κ³Ό

### 2.1 μ„±λ¥ λΉ„κµν‘

| μ„¤μ • | AUC | Accuracy | F1-Score | Precision | Recall |
|------|-----|----------|----------|-----------|--------|
| **Phase3 Full** | **0.820** | 0.793 | 0.465 | 0.345 | 0.714 |
| **ECMiner Only (4 params)** | **0.834** | 0.793 | 0.489 | 0.355 | **0.786** |
| **ECMiner + colsample (5 params)** | **0.820** | **0.811** | **0.512** | **0.379** | **0.786** |

### 2.2 μ£Όμ” λ°κ²¬

#### β… **ECMiner 4κ°€μ§€ νλΌλ―Έν„°λ§μΌλ΅λ„ Phase3 μ„±λ¥ λ‹¬μ„± κ°€λ¥!**

- **ECMiner Only AUC**: 0.834 (Phase3 λ€λΉ„ **+0.013**)
- **ECMiner + colsample AUC**: 0.820 (Phase3 λ€λΉ„ -0.001)

β†’ **μ •κ·ν™” νλΌλ―Έν„°(min_child_weight, reg_lambda, reg_alpha) μ—†μ΄λ„ λ™λ“± λλ” λ” λ‚μ€ μ„±λ¥**

#### π” **μ„±λ¥ ν–¥μƒ μ›μΈ λ¶„μ„**

**Phase3μ κ°•ν• μ •κ·ν™”κ°€ μ¤νλ ¤ μ–Έλ”ν”Όν…μ„ μ λ°ν–μ„ κ°€λ¥μ„±**:

1. **min_child_weight=5**: λ¦¬ν”„ λ…Έλ“ μµμ† κ°€μ¤‘μΉ μ μ•½ β†’ λ¨λΈ λ³µμ΅λ„ β†“
2. **reg_lambda=5**: L2 μ •κ·ν™” κ°•ν™” β†’ κ°€μ¤‘μΉ ν¬κΈ° μ–µμ 
3. **reg_alpha=1**: L1 μ •κ·ν™” μ¶”κ°€ β†’ ν¬μ†μ„± μ λ„

**ECMiner Only μ„¤μ •μ΄ λ” λ‚μ€ μ΄μ **:
- ν„μ¬ λ°μ΄ν„°μ…‹ (898 windows)μ— μ ν•©ν• μμ—°μ¤λ¬μ΄ λ³µμ΅λ„
- κ³Όμ ν•© μ„ν—μ΄ μ μ€ μ†κ·λ¨ λ°μ΄ν„°
- max_depth=3, subsample=0.8λ΅ μ¶©λ¶„ν• κ³Όμ ν•© λ°©μ§€

### 2.3 Confusion Matrix λΉ„κµ

#### Phase3 Full
```
[[78 19]    β† Abnormal: 78 μ •λ‹µ, 19 μ¤λ‹µ
 [ 4 10]]   β† Normal: 10 μ •λ‹µ, 4 μ¤λ‹µ
```
- **Normal Recall**: 10/14 = 71.4%

#### ECMiner Only
```
[[77 20]    β† Abnormal: 77 μ •λ‹µ, 20 μ¤λ‹µ
 [ 3 11]]   β† Normal: 11 μ •λ‹µ, 3 μ¤λ‹µ
```
- **Normal Recall**: 11/14 = **78.6%** β†‘

#### ECMiner + colsample
```
[[79 18]    β† Abnormal: 79 μ •λ‹µ, 18 μ¤λ‹µ  β† μµκ³ 
 [ 3 11]]   β† Normal: 11 μ •λ‹µ, 3 μ¤λ‹µ
```
- **Normal Recall**: 11/14 = **78.6%** β†‘
- **Abnormal Precision**: 79/82 = **96.3%** β†‘β†‘

---

## 3. ECMiner κ¶μ¥ ν•μ΄νΌνλΌλ―Έν„°

### 3.1 μµμΆ… κ¶μ¥ μ„¤μ •

**ECMiner XGBoost λ…Έλ“ μ„¤μ •** (Phase3 κΈ°λ°):

| νλΌλ―Έν„° | κ¶μ¥κ°’ | μ„¤λ… |
|---------|--------|------|
| **μ΄ λ‚λ¬΄ μ** | 100 | μ¶©λ¶„ν• ν•™μµ, κ³Όμ ν•© μ„ν— λ‚®μ |
| **μµλ€ νΈλ¦¬ κΉμ΄** | 3 | κ³Όμ ν•© λ°©μ§€ (Phase3 κ²€μ¦λ¨) |
| **μƒν”λ§ λΉ„μ¨** | 0.8 | λ¶€νΈμ¤νΈλ© μƒν”λ§μΌλ΅ μΌλ°ν™” ν–¥μƒ |
| **ν•™μµλ¥ ** | 0.1 | μ μ ν• μλ ΄ μ†λ„ |

### 3.2 μ¶”κ°€ κ³ λ ¤μ‚¬ν•­

**ECMinerμ—μ„ μ΅°μ • λ¶κ°€λ¥ν• μ¤‘μ” νλΌλ―Έν„°** (κΈ°λ³Έκ°’ μ‚¬μ©):
- `scale_pos_weight`: ν΄λμ¤ λ¶κ· ν• ν•΄κ²° (μλ™ κ³„μ‚° κ¶μ¥)
- `colsample_bytree`: νΉμ„± μƒν”λ§ (0.8~1.0 κ¶μ¥, ECMiner κΈ°λ³Έκ°’ ν™•μΈ ν•„μ”)

---

## 4. Stage1 μ¤ν¬λ¦½νΈ μ΄μ

### 4.1 ν„μ¬ λ¬Έμ 

**`ecminer_stage1_feature_extraction.py` κ²€μ¦ κ²°κ³Ό**:

- 32κ° νμΌλ§ μ΅΄μ¬ (60κ° μ¤‘) β†’ 462 windows (μ›λ 898 λ€μ‹ )
- **Stage1 μ¶”μ¶ νΉμ„± β‰  Phase3 νΉμ„±**:
  - Stage1: `acc_Y_rms`, `acc_X_rms`, `Gyro_Y_rms`, `Gyro_X_rms`, ...
  - Phase3: `acc_Y_rms`, `acc_Sum_rms`, `Gyro_Y_rms`, `acc_Y_peak`, ...
- **μ„±λ¥ μ €ν•**: AUC 0.481 (Phase3 λ€λΉ„ -0.339)

### 4.2 λ¬Έμ  μ›μΈ

1. **λ°μ΄ν„° λ„λ½**: μ›λ³Έ Raw CSV νμΌ 28κ° μ—†μ
2. **νΉμ„± λ¶μΌμΉ**: Stage1μ΄ Phase3μ™€ λ‹¤λ¥Έ νΉμ„± κ³„μ‚°
   - `acc_Sum_rms` λ€μ‹  `acc_X_rms`, `Gyro_X_rms` μ‚¬μ©
   - `Gyro_Y_peak`, `Gyro_Y_crest` λ„λ½

### 4.3 ν•΄κ²° λ°©μ•

#### λ‹¨κΈ° (ECMiner ν…μ¤νΈμ©)
1. **Phase3 νΉμ„± μ¶”μ¶ λ΅μ§μ„ Stage1μ— μ •ν™•ν λ³µμ **
   - `src/features/time_domain.py` μ°Έκ³ 
   - `acc_Sum`, `Gyro_Y` Peak/Crest κ³„μ‚° μ¶”κ°€

2. **λ„λ½ νμΌ λ³µκµ¬ λλ” λ€μ²΄**
   - μ›λ³Έ μΈ΅μ • λ°μ΄ν„° μ„μΉ ν™•μΈ
   - λλ” κΈ°μ΅΄ 32κ° νμΌλ΅λ§ μ‘μ€ κ·λ¨ ν…μ¤νΈ

#### μ¥κΈ° (ν”„λ΅λ•μ…)
1. **ν†µν•© νΉμ„± μ¶”μ¶ λ¨λ“ κ°λ°**
   - Phase3 κ²€μ¦λ λ΅μ§μ„ λΌμ΄λΈλ¬λ¦¬ν™”
   - Stage1, Phase3, ECMiner λ¨λ‘ λ™μΌ λ΅μ§ μ‚¬μ©

2. **λ°μ΄ν„° νμ΄ν”„λΌμΈ ν‘μ¤€ν™”**
   - Raw CSV β†’ Processed Parquet ν‘μ¤€ ν”„λ΅μ„Έμ¤
   - νΉμ„± μ •μ λ¬Έμ„ν™” λ° λ²„μ „ κ΄€λ¦¬

---

## 5. κ²°λ΅  λ° κ¶μ¥μ‚¬ν•­

### 5.1 μ£Όμ” κ²°λ΅ 

β… **ECMiner 4κ°€μ§€ νλΌλ―Έν„°λ§μΌλ΅ Phase3 μ„±λ¥ μ¬ν„ κ°€λ¥**
- ECMiner Only: AUC 0.834 (Phase3 λ€λΉ„ +0.013)
- ECMiner + colsample: AUC 0.820 (Phase3 λ€λΉ„ -0.001)

β… **Phase3 μ •κ·ν™” νλΌλ―Έν„°λ” μ΄ λ°μ΄ν„°μ…‹μ— κ³Όλ„ν–μ„ κ°€λ¥μ„±**
- μ†κ·λ¨ λ°μ΄ν„°(898 windows)μ—λ” κ°„λ‹¨ν• μ„¤μ •μ΄ λ” ν¨κ³Όμ 
- max_depth=3, subsample=0.8λ΅ μ¶©λ¶„ν• μΌλ°ν™”

β οΈ **Stage1 μ¤ν¬λ¦½νΈλ” Phase3 νΉμ„±κ³Ό λ¶μΌμΉ**
- λ°μ΄ν„° λ„λ½ + νΉμ„± κ³„μ‚° μ°¨μ΄λ΅ μ„±λ¥ μ €ν•
- ECMiner ν†µν•© μ „ νΉμ„± μ¶”μ¶ λ΅μ§ μμ • ν•„μ”

### 5.2 ECMiner ν†µν•© κ¶μ¥μ‚¬ν•­

#### μ¦‰μ‹ μ μ© κ°€λ¥
1. **XGBoost λ…Έλ“ νλΌλ―Έν„°**:
   - μ΄ λ‚λ¬΄ μ: 100
   - μµλ€ νΈλ¦¬ κΉμ΄: 3
   - μƒν”λ§ λΉ„μ¨: 0.8
   - ν•™μµλ¥ : 0.1

2. **μ›ν¬ν”λ΅μ°**:
   ```
   Data Source β†’ Filter (ν•„μ”μ‹) β†’ Python μ—°λ™ (Stage1)
   β†’ Filter (18β†’12 νΉμ„±) β†’ XGBoost (μ„ νλΌλ―Έν„°) β†’ ν‰κ°€
   ```

#### κ°μ„  ν›„ μ μ©
1. **Stage1 μ¤ν¬λ¦½νΈ μμ •**:
   - Phase3 νΉμ„± μ¶”μ¶ λ΅μ§ μ •ν™•ν λ³µμ 
   - λ„λ½ νμΌ λ³µκµ¬ λλ” λ°μ΄ν„°μ…‹ μ¬κµ¬μ„±

2. **ν†µν•© ν…μ¤νΈ**:
   - μ „μ²΄ 898 windowsλ΅ μ¬κ²€μ¦
   - AUC 0.82+ λ©ν‘ λ‹¬μ„± ν™•μΈ

3. **ν”„λ΅λ•μ… λ°°ν¬**:
   - ECMiner μ›ν¬ν”λ΅μ° ν…ν”λ¦Ώ μƒμ„±
   - μ‚¬μ©μ κ°€μ΄λ“ λ° νλΌλ―Έν„° μ„¤λ… λ¬Έμ„ν™”

---

## λ¶€λ΅ A: νλΌλ―Έν„° μƒμ„Έ μ„¤λ…

### ECMiner μ΅°μ • κ°€λ¥ νλΌλ―Έν„°

| νλΌλ―Έν„° | λ²”μ„ | Phase3 κ°’ | μ„¤λ… |
|---------|------|-----------|------|
| **n_estimators** | 50-500 | 100 | νΈλ¦¬ κ°μ. λ§μ„μλ΅ μ„±λ¥β†‘ μ‹κ°„β†‘ |
| **max_depth** | 2-10 | 3 | νΈλ¦¬ κΉμ΄. μ‘μ„μλ΅ κ³Όμ ν•©β†“ μ„±λ¥β†“ |
| **subsample** | 0.5-1.0 | 0.8 | μƒν”λ§ λΉ„μ¨. μ‘μ„μλ΅ κ³Όμ ν•©β†“ |
| **learning_rate** | 0.01-0.3 | 0.1 | ν•™μµλ¥ . μ‘μ„μλ΅ μ•μ •β†‘ μ‹κ°„β†‘ |

### ECMinerμ—μ„ μ΅°μ • λ¶κ°€λ¥ (κΈ°λ³Έκ°’ μ‚¬μ©)

| νλΌλ―Έν„° | Phase3 κ°’ | ECMiner κΈ°λ³Έκ°’ | μν–¥ |
|---------|-----------|---------------|------|
| **min_child_weight** | 5 | 1 | λ¦¬ν”„ λ…Έλ“ μµμ† κ°€μ¤‘μΉ |
| **reg_lambda** | 5 | 1 | L2 μ •κ·ν™” κ°•λ„ |
| **reg_alpha** | 1 | 0 | L1 μ •κ·ν™” κ°•λ„ |
| **colsample_bytree** | 0.8 | 1.0 | νΉμ„± μƒν”λ§ λΉ„μ¨ |
| **scale_pos_weight** | μλ™ | 1 | ν΄λμ¤ λ¶κ· ν• ν•΄κ²° |

---

## λ¶€λ΅ B: μ¬ν„ μ¤ν¬λ¦½νΈ

κ²€μ¦μ— μ‚¬μ©ν• μ¤ν¬λ¦½νΈ: `validate_ecminer_with_phase3_data.py`

**μ‹¤ν–‰ λ°©λ²•**:
```bash
cd /path/to/project
python3 validate_ecminer_with_phase3_data.py
```

**μ¶λ ¥**:
- μ½μ†”: 3κ°€μ§€ μ„¤μ • λΉ„κµ κ²°κ³Ό
- JSON: `ecminer_param_comparison_results.json`

**κ²°κ³Ό ν™•μΈ**:
```bash
cat ecminer_param_comparison_results.json | jq '.analysis'
```

---

**λ³΄κ³ μ„ μ‘μ„±**: Claude Code
**κ²€μ¦ κΈ°κ°„**: 2025-11-24
**λ°μ΄ν„°**: Phase3 μ›λ³Έ (898 windows, 12 features)
**λ©ν‘ λ‹¬μ„±**: β… ECMiner 4κ°€μ§€ νλΌλ―Έν„°λ΅ Phase3 μ„±λ¥(AUC 0.820) μ¬ν„
