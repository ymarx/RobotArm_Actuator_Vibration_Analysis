# NeuroM_RoboticArm-진동분석 프로젝트 개요 (상위 설계 문서)

Created: 2025년 11월 17일 오전 11:01

# NeuroM_RoboticArm-진동분석 프로젝트 개요 (상위 설계 문서)

이 문서는 **전체 프로젝트 진행 시 항상 참조하는 상위 설계서**다.

탐색적 분석(EDA), 1차/2차 본 분석, 운영 단계까지 **공통으로 유지해야 할 원칙과 구조**를 정의한다.

---

## 1. 프로젝트 목표

### 1.1 데이터 기반 목표

- 로봇팔(100W / 200W 제품)의 진동 데이터를 이용해:
    1. **정상 vs 비정상(소음/진동)** 상태를 구분하는 분류 모델을 만든다.
    2. 장기적으로 **새로운 이상 패턴**도 감지할 수 있는 **이상탐지(오토인코더 기반)** 구조를 만든다.

### 1.2 분석 단계 구분

- **1차 단계**
    - 초점:
        - 데이터 구조/품질 파악
        - 시간영역 중심 feature + XGBoost로 베이스라인 구축
    - 산출물:
        - 표준 전처리 코드 (메타데이터 분리, 이상치 처리, 세그먼트 생성)
        - 윈도우 단위 feature 테이블 + XGBoost 베이스라인 성능
        - 간단한 feature 기반 오토인코더 골격(정상 데이터만 학습)
- **2차 단계**
    - 초점:
        - 주파수/오더/베어링 특화 feature 추가
        - 오토인코더/고급 모델(1D-CNN, LSTM 등) 고도화
        - 운영/프로덕션 구조 설계 (threshold, 드리프트 모니터링 등)
    - 산출물:
        - 고성능/해석 가능한 모델
        - 실제 시스템에 붙일 수 있는 판단 로직(정상/경고/이상)

---

## 2. 데이터 구조 및 공통 전제

### 2.1 파일 종류

1. **CSV (시계열 데이터)**
    - 상단: 메타데이터(여러 줄의 "Key,Value" 형식)
        - 예: `MeasFreq`, `Resampling`, `LowFreq`, `HighFreq`, `xRMS`, `sumRMS`, `xPeak` 등
    - `DataSet` 라인 이후: **시계열 테이블**
        - 열 예시:`TimeStamp, acc-X, acc-Y, acc-Z, Gyro-X, Gyro-Y, Gyro-Z, acc-Sum`
2. **엑셀 (시료 정보 및 라벨)**
    - 각 파일(시료)에 대한:
        - 제품: 100W / 200W
        - 방향: CW / CCW
        - 라벨: 정상 / 소음 / 진동 / 표기없음
        - 기타 메모, 시료 ID 등

### 2.2 진동/주파수 관련 기본 전제

- CSV 메타데이터 기준:
    - `Resampling` ≈ 512 Hz (샘플링 주파수)
    - `LowFreq = 1`, `HighFreq = 150`
- 실제 스펙트럼을 보면 **150 Hz 이상 성분이 거의 없음**
→ 데이터는 이미 **1–150 Hz 대역으로 밴드 제한된 상태**라고 본다.
- 따라서 **추가로 “1–150 Hz 밴드패스 필터”를 전처리로 다시 적용하지 않는다.**
    - 단, 2차 단계에서 **특정 부분 대역(예: 1–30, 30–80, 80–150 Hz)** feature를 추출하기 위한 **추가 밴드패스**는 허용/활용한다.

---

## 3. 표준 전처리 파이프라인 (상위 개념)

**항상 이 순서를 기본으로 한다.**

1. **로우 CSV 로드 + 메타데이터 분리**
    - CSV 파일에서 **헤더 메타데이터**와 **시계열 DataSet**을 분리한다.
    - 메타데이터는 별도 테이블(파일 단위)로, 시계열은 통합 시계열 테이블에 저장한다.
2. **엑셀 라벨/정보 매핑**
    - 각 CSV 파일에 대해:
        - 제품(100W/200W), 방향(CW/CCW), 라벨(정상/소음/진동/표기없음) 정보를 붙인다.
    - 이 매핑 결과는 **“파일 마스터 테이블”**로 관리한다.
3. **데이터 정제(클리닝)**
    - TimeStamp → 상대 시간(초) 변환
    - NaN/결측치 처리
    - 센서 스파이크, 클리핑 등 **이상치(outlier) 탐지 및 처리**
    - 채널별/파일별 품질 진단
        - 심각한 이상이 있는 파일/구간은 **제외·마스킹 규칙**을 문서화해서 일관되게 적용한다.
4. **세그먼트(윈도우) 분할**
    - 파일 단위로:
        - 안정 구간만 추출 (앞/뒤 일부 구간 제외)
        - 일정 길이(예: 0.5~1초) 윈도우 + hop(50% overlap 등)으로 나눈다.
    - 각 윈도우에:
        - 파일 라벨(정상/비정상)
        - 제품/방향 등 메타 정보
        를 상속한다.
5. **feature 추출**
    - 1차 단계:
        - 시간영역 feature (RMS, Peak, crest factor, kurtosis 등)
    - 2차 단계:
        - 주파수/오더/베어링 특화 feature 추가
6. **모델 학습/평가**
    - 1차: XGBoost 이진 분류(정상 vs 비정상) 베이스라인
    - 2차: XGBoost 고도화 + 오토인코더 기반 이상탐지

---

## 4. 디렉터리 / 모듈 구조 제안

아래 구조는 **클로드 코드(코딩 에이전트)**가 따라야 할 기본 골격이다.

```
project_root/
  data/
    raw/           # 원본 csv, 엑셀
    interim/       # 메타 분리, 정제 중간 산출물
    processed/     # 세그먼트 & feature 테이블
  notebooks/
    eda/           # 탐색적 분석 노트북
    experiments/   # 모델 실험 노트북
  src/
    io/
      load_raw.py          # csv/엑셀 로딩 및 메타 분리
    preprocess/
      clean_timeseries.py  # 이상치 처리, 품질 진단
      segment.py           # 윈도우 분할
    features/
      time_domain.py       # 시간영역 feature
      freq_domain.py       # 주파수/오더 feature (2차 단계)
    models/
      xgboost_baseline.py  # 1차 XGBoost
      autoencoder.py       # AE 모델 (feature 기반, 이후 시계열 AE로 확장)
    config/
      paths.yaml           # 경로, 파일명 패턴
      params_stage1.yaml   # 윈도우 길이, hop, 기본 feature, XGBoost 파라미터
      params_stage2.yaml   # 추가 feature, AE 구조, etc
  docs/
    00_project_analysis_overview.md   # (이 문서)
    01_eda_and_preprocessing_plan.md  # 상세 EDA/정제/세그먼트/feature 설계
5. “탐색적 분석 + 본 분석”을 함께 고려하는 원칙
탐색적 분석(EDA)을 위한 코드와
본 분석(1차/2차 모델 학습)을 위한 코드는 같은 전처리/세그먼트/feature 모듈을 사용해야 한다.

즉, 전처리 로직을 노트북 안에 즉흥적으로 쓰지 말고
src/preprocess/*.py, src/features/*.py에 함수로 정의한다.

EDA 노트북은:

“어떤 feature가 구분에 잘 듣는지”를 시각화/검증하는 용도이고,

전처리/세그먼트/feature 추출 자체는 재사용 가능한 모듈에서 가져다 쓴다.

1차/2차 본 분석 코드는:

config/*.yaml + src/* 모듈 조합으로 돌아가도록 설계하여

나중에 데이터가 추가되거나 조건이 바뀌어도 설정만 바꿔 재실행 가능하게 한다.
```